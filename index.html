<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Spaced Repetition Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .card { transition: all 0.3s ease; }
        .card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        .spinner { border: 3px solid rgba(255, 255, 255, 0.3); border-radius: 50%; border-top-color: #fff; width: 20px; height: 20px; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <header class="mb-10 text-center">
            <h1 class="text-4xl font-bold text-slate-800 mb-2">ğŸ§  ì—ë¹™í•˜ìš°ìŠ¤ ê·¹ë³µ í”Œë˜ë„ˆ</h1>
            <p class="text-slate-600">ê°„ê²© ë°˜ë³µ í•™ìŠµê³¼ AI ì—°ìƒ ì•”ê¸° ë„ìš°ë¯¸</p>
        </header>

        <!-- Input Section -->
        <section class="bg-white p-6 rounded-2xl shadow-sm mb-8 border border-slate-200">
            <h2 class="text-xl font-semibold mb-4 text-slate-700">ìƒˆë¡œìš´ í•™ìŠµ ë‚´ìš© ì¶”ê°€</h2>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-500 mb-1">í•™ìŠµ ì£¼ì œ</label>
                    <input id="topicInput" type="text" placeholder="ì˜ˆ: ê´‘í•©ì„± ì‘ìš©, ì˜ë‹¨ì–´ 'Ephemeral'" class="w-full p-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition">
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-500 mb-1">í•µì‹¬ ìš”ì•½</label>
                    <textarea id="contentInput" rows="3" placeholder="ê¸°ì–µí•˜ê³  ì‹¶ì€ í•µì‹¬ ë‚´ìš©ì„ ì ì–´ì£¼ì„¸ìš”." class="w-full p-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition"></textarea>
                </div>
                <div class="flex gap-2">
                    <button onclick="addStudyItem()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition">
                        í”Œëœì— ì¶”ê°€í•˜ê¸°
                    </button>
                    <button onclick="generateMnemonics()" id="aiBtn" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 rounded-lg transition flex items-center justify-center gap-2">
                        <span>âœ¨ AI ì—°ìƒ ë„ìš°ë¯¸</span>
                    </button>
                </div>
            </div>
            <!-- AI Output Area -->
            <div id="aiOutput" class="hidden mt-4 p-4 bg-purple-50 rounded-lg border border-purple-100 text-purple-900 text-sm leading-relaxed">
                <!-- AI content will be injected here -->
            </div>
        </section>

        <!-- Dashboard -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 text-center">
                <span class="block text-2xl font-bold text-blue-600" id="statTotal">0</span>
                <span class="text-xs text-slate-500 uppercase tracking-wider">ì „ì²´ í•™ìŠµ</span>
            </div>
            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 text-center">
                <span class="block text-2xl font-bold text-orange-600" id="statToday">0</span>
                <span class="text-xs text-slate-500 uppercase tracking-wider">ì˜¤ëŠ˜ ë³µìŠµ í•„ìš”</span>
            </div>
            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 text-center">
                <span class="block text-2xl font-bold text-green-600" id="statMastered">0</span>
                <span class="text-xs text-slate-500 uppercase tracking-wider">ì™„ë£Œëœ í•™ìŠµ</span>
            </div>
        </div>

        <!-- Study List -->
        <section>
            <h2 class="text-xl font-semibold mb-4 text-slate-700">ë‚˜ì˜ ë³µìŠµ íƒ€ì„ë¼ì¸</h2>
            <div id="studyList" class="space-y-4">
                <!-- Items will be added here -->
                <div class="text-center py-10 text-slate-400 italic">
                    ì•„ì§ ë“±ë¡ëœ í•™ìŠµ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤. ìœ„ì—ì„œ ì²« í•™ìŠµì„ ì‹œì‘í•´ë³´ì„¸ìš”!
                </div>
            </div>
        </section>
    </div>

    <script>
        const apiKey = "AIzaSyCBxNmth3HeIvPjDRTDBhGkZAPPhMJEMac"; // API key is handled by the environment
        let studyItems = JSON.parse(localStorage.getItem('spaced_items') || '[]');

        function saveItems() {
            localStorage.setItem('spaced_items', JSON.stringify(studyItems));
            renderItems();
            updateStats();
        }

        function addStudyItem() {
            const topic = document.getElementById('topicInput').value;
            const content = document.getElementById('contentInput').value;
            if (!topic) return;

            const newItem = {
                id: Date.now(),
                topic,
                content,
                createdAt: new Date().toISOString(),
                nextReview: new Date().toISOString(),
                level: 0, // 0: Today, 1: 1d, 2: 3d, 3: 7d, 4: 14d, 5: 30d
                history: []
            };

            studyItems.unshift(newItem);
            saveItems();
            
            document.getElementById('topicInput').value = '';
            document.getElementById('contentInput').value = '';
            document.getElementById('aiOutput').classList.add('hidden');
        }

        function getIntervalDays(level) {
            const intervals = [1, 3, 7, 14, 30, 60];
            return intervals[level] || 90;
        }

        function markReview(id, success) {
            const item = studyItems.find(i => i.id === id);
            if (!item) return;

            if (success) {
                const days = getIntervalDays(item.level);
                const nextDate = new Date();
                nextDate.setDate(nextDate.getDate() + days);
                item.nextReview = nextDate.toISOString();
                item.level++;
            } else {
                item.level = 0;
                item.nextReview = new Date().toISOString();
            }
            
            saveItems();
        }

        function deleteItem(id) {
            studyItems = studyItems.filter(i => i.id !== id);
            saveItems();
        }

        async function generateMnemonics() {
            const topic = document.getElementById('topicInput').value;
            const content = document.getElementById('contentInput').value;
            const aiBtn = document.getElementById('aiBtn');
            const aiOutput = document.getElementById('aiOutput');

            if (!topic) {
                showSimpleMessage("ì£¼ì œë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }

            aiBtn.disabled = true;
            aiBtn.innerHTML = '<div class="spinner"></div> ìƒì„± ì¤‘...';
            aiOutput.classList.remove('hidden');
            aiOutput.innerHTML = "âœ¨ AIê°€ ì—°ìƒ ê¸°ë²•ê³¼ ë°°ê²½ì§€ì‹ì„ ì°¾ëŠ” ì¤‘ì…ë‹ˆë‹¤...";

            const prompt = `ì£¼ì œ: ${topic}\në‚´ìš©: ${content}\n\nìœ„ ë‚´ìš©ì„ ì—ë¹™í•˜ìš°ìŠ¤ ë§ê°ê³¡ì„ ì„ ê·¹ë³µí•  ìˆ˜ ìˆë„ë¡ ì¥ê¸° ê¸°ì–µìœ¼ë¡œ ì „í™˜í•˜ê¸° ìœ„í•œ 'ì—°ìƒ ì•”ê¸°ë²•(Mnemonic)'ê³¼ ì´ì™€ ê´€ë ¨ëœ 'í¥ë¯¸ë¡œìš´ ë°°ê²½ì§€ì‹'ì„ í•œêµ­ì–´ë¡œ ì‘ì„±í•´ì¤˜. ê¸°ì–µí•˜ê¸° ì‰¬ìš´ ë¹„ìœ ë‚˜ ì—­ì‚¬ì  ì‚¬ì‹¤, ìœ ë¨¸ë¥¼ ì„ì–´ì„œ ì§§ê³  ê°•ë ¬í•˜ê²Œ ì¨ì¤˜.`;

            try {
                let success = false;
                let retries = 0;
                let resultText = "";

                while (!success && retries < 5) {
                    try {
                        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                contents: [{ parts: [{ text: prompt }] }]
                            })
                        });
                        const data = await response.json();
                        resultText = data.candidates?.[0]?.content?.parts?.[0]?.text;
                        if (resultText) success = true;
                    } catch (e) {
                        retries++;
                        await new Promise(r => setTimeout(r, Math.pow(2, retries) * 1000));
                    }
                }

                if (success) {
                    aiOutput.innerHTML = `<strong>ğŸ’¡ AI ì•”ê¸° íŒ:</strong><br>${resultText.replace(/\n/g, '<br>')}`;
                } else {
                    aiOutput.innerHTML = "âŒ AI ìš”ì²­ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
                }
            } catch (err) {
                aiOutput.innerHTML = "âŒ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
            } finally {
                aiBtn.disabled = false;
                aiBtn.innerHTML = 'âœ¨ AI ì—°ìƒ ë„ìš°ë¯¸';
            }
        }

        function showSimpleMessage(msg) {
            const div = document.createElement('div');
            div.className = "fixed top-4 right-4 bg-slate-800 text-white p-3 rounded shadow-lg z-50 transition-opacity duration-500";
            div.innerText = msg;
            document.body.appendChild(div);
            setTimeout(() => {
                div.style.opacity = '0';
                setTimeout(() => div.remove(), 500);
            }, 2000);
        }

        function updateStats() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('statTotal').innerText = studyItems.length;
            document.getElementById('statToday').innerText = studyItems.filter(i => i.nextReview.split('T')[0] <= today).length;
            document.getElementById('statMastered').innerText = studyItems.filter(i => i.level > 4).length;
        }

        function renderItems() {
            const list = document.getElementById('studyList');
            if (studyItems.length === 0) {
                list.innerHTML = '<div class="text-center py-10 text-slate-400 italic">ì•„ì§ ë“±ë¡ëœ í•™ìŠµ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }

            const todayStr = new Date().toISOString().split('T')[0];

            list.innerHTML = studyItems.map(item => {
                const isDue = item.nextReview.split('T')[0] <= todayStr;
                const nextDate = new Date(item.nextReview).toLocaleDateString();
                
                return `
                    <div class="card bg-white p-5 rounded-xl shadow-sm border ${isDue ? 'border-orange-300 bg-orange-50' : 'border-slate-200'}">
                        <div class="flex justify-between items-start mb-2">
                            <div>
                                <span class="text-xs font-bold px-2 py-1 rounded bg-slate-100 text-slate-500 uppercase">Level ${item.level}</span>
                                ${isDue ? '<span class="text-xs font-bold px-2 py-1 rounded bg-orange-500 text-white ml-2">ë³µìŠµ í•„ìš”</span>' : ''}
                            </div>
                            <button onclick="deleteItem(${item.id})" class="text-slate-400 hover:text-red-500">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                            </button>
                        </div>
                        <h3 class="text-lg font-bold text-slate-800">${item.topic}</h3>
                        <p class="text-sm text-slate-600 mt-1 mb-4">${item.content || 'ë‚´ìš© ì—†ìŒ'}</p>
                        
                        <div class="flex items-center justify-between mt-4 pt-4 border-t border-slate-100">
                            <span class="text-xs text-slate-400">ë‹¤ìŒ ë³µìŠµ: ${nextDate}</span>
                            <div class="flex gap-2">
                                <button onclick="markReview(${item.id}, false)" class="text-xs font-semibold px-3 py-1.5 rounded border border-slate-300 text-slate-600 hover:bg-slate-50 transition">ê¹Œë¨¹ìŒ</button>
                                <button onclick="markReview(${item.id}, true)" class="text-xs font-semibold px-3 py-1.5 rounded bg-blue-600 text-white hover:bg-blue-700 transition">ê¸°ì–µí•¨!</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Init
        renderItems();
        updateStats();
    </script>
</body>
</html># memorize
